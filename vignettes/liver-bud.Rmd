---
title: "Liver bud development"
author: "Yutong Wang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignette, we analyze the liver bud dataset from [Camp et al 2017](https://www.nature.com/articles/nature22796)

```{r}

con <- gzcon(url("ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE81nnn/GSE81252/suppl/GSE81252_data.cast.log2.liverbud.csv.gz"))
txt <- readLines(con)

liverbud <- read.csv(file = textConnection(txt))

metadata <- liverbud[,1:3]
counts <- t(as.matrix(liverbud[,4:ncol(liverbud)]))

colnames(counts) <- metadata$cell_id

rownames(metadata) <- metadata$cell_id

LB_status <- unlist(lapply(metadata$assignment_LB,function(x) ifelse(test = grepl("LB",x),yes = "LB",no = "IN")))
lineage <- as.factor(unlist(lapply(X = metadata$assignment_LB,FUN = function(x) strsplit(as.character(x),split = "-",fixed = T)[[1]][1])))

table(LB_status,lineage)
```

